digraph fc{
	label="Calling iSNVs for samples with known reference sequence";
	fontname="arial";
	fontsize=18;
	nodesep=0.8;
	node [shape=Mrecord,
	      color="#2b2b2b",
	      fillcolor="#ececec",
	      style="filled,solid",
	      fontsize=18,
	      fontname = "arial",
	      fontcolor="#2b2b2b"]
	edge[color="#5c5c5c"];

        subgraph cluster_rep1{
		label="Replicate 1";
		graph[style=dotted];
		align1 [label="{Align reads\nto reference | bwa mem}",
			fillcolor="/ylgnbu3/1",
			color="#2b2b2b",
			fontcolor="#2b2b2b"];
		trim1 [label="{Primmer Trimming\nQuality Trimming | ivar trim}",
		       fillcolor="/ylgnbu3/3",
		       color="#ececec",
		       fontcolor="#ececec"];
		vc1 [label="{Variant Calling\n3% minimum frequency | samtools mpileup\nivar variants}",
		     fillcolor="/ylgnbu3/2",
		     color="#2b2b2b",
		     fontcolor="#2b2b2b"];
		rr1 [label="{Remove reads from amplicons\nwith mismatched primers | ivar getmasked\nivar removereads}",
		     fillcolor="/ylgnbu3/3",
		     color="#ececec",
		     fontcolor="#ececec"];
		vc2_1 [label="{Redo variant Calling\n3% minimum frequency | samtools mpileup\nivar variants}",
		       fillcolor="/ylgnbu3/2",
		       color="#2b2b2b",
		       fontcolor="#2b2b2b"];
	}

        subgraph cluster_rep2{
		label="Replicate 2";
		graph[style=dotted];
		align2 [label="{Align reads\nto reference | bwa mem}",
			fillcolor="/ylgnbu3/1",
			color="#2b2b2b",
			fontcolor="#2b2b2b"];
		trim2 [label="{Primmer Trimming\nQuality Trimming | ivar trim}",
		       fillcolor="/ylgnbu3/3",
		       color="#ececec",
		       fontcolor="#ececec"];
		vc2 [label="{Variant Calling\n3% minimum frequency | samtools mpileup\nivar variants}",
		     fillcolor="/ylgnbu3/2",
		     color="#2b2b2b",
		     fontcolor="#2b2b2b"];
		rr2 [label="{Remove reads from amplicons\nwith mismatched primers | ivar getmasked\nivar removereads}",
		     fillcolor="/ylgnbu3/3",
		     color="#ececec",
		     fontcolor="#ececec"];
		vc2_2 [label="{Redo variant Calling\n3% minimum frequency | samtools mpileup\nivar variants}",
		       fillcolor="/ylgnbu3/2",
		       color="#2b2b2b",
		       fontcolor="#2b2b2b"];
        }

	subgraph combine{
		c [label="{Get intersection of iSNVs called across replicates | ivar filtervariants}",
		       fillcolor="/ylgnbu3/3",
		       color="#ececec",
		       fontcolor="#ececec"];
	       }

	// subgraph cluster_commands{
	// 	label="Commands";
	// 	graph[penwidth=0];
	// 	node [shape=record,
	// 	      color="#2b2b2b",
	// 	      fillcolor="#ffffff",
	// 	      style="filled,solid",
	// 	      fontsize=18,
	// 	      fontname = "arial bold italic",
	// 	      fontcolor="#2b2b2b"];
	// 	aligncmd [label="bwa mem ... \l"];
	// 	trimcmd [label="ivar trim ... \lsamtools sort ...\lsamtools index ... "];
	// 	vc1cmd [label="samtools mpileup ... \| ivar variants ... \l"];
	// 	rrcmd [label="ivar getmasked ... \livar removereads ... \l"];
	// 	vc2cmd [label="samtools mpileup ... \| ivar variants ... \l"];
	// 	combinecmd [label="ivar filtervariants ... \l"];
	// }

	align1 -> trim1 -> vc1 -> rr1 -> vc2_1 -> c
	align2 -> trim2 -> vc2 -> rr2 -> vc2_2 -> c
	// aligncmd->trimcmd->vc1cmd->rrcmd->vc2cmd->combinecmd[style=invis]
}